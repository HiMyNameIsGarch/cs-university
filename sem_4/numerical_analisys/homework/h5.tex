\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}
\usepackage{colortbl} % For cell coloring
\usepackage{amssymb} % For additional symbols

\title{Homework 5, Section B}
\author{Gabriel Hanu}
\date{17 May 2025 \\
Numerical Analysis}


\begin{document}

\maketitle

\section*{Problem 1}
Find the degree of exactness of the following quadrature formula:
\[
    \int_{-1}^{1} f(x) \, dx = \frac{2}{3} \big[f(-1) + f(0) + f(1)\big] +R(f)
\]
We assume the general form of the quadrature:

\[
\int_{-1}^{1} f(x)\,dx \approx A f(-1) + B f(0) + C f(1)
\]

Let the interpolation nodes be \( x_0 = -1 \), \( x_1 = 0 \), \( x_2 = 1 \), and define the Lagrange basis polynomials:

\[
\ell_0(x) = \frac{(x - 0)(x - 1)}{(-1 - 0)(-1 - 1)} = \frac{x(x - 1)}{2}
\]

\[
\ell_1(x) = \frac{(x + 1)(x - 1)}{(0 + 1)(0 - 1)} = - (x + 1)(x - 1)
\]

\[
\ell_2(x) = \frac{(x + 1)(x)}{(1 + 1)(1 - 0)} = \frac{(x + 1)(x)}{2}
\]

Now integrate each basis polynomial over the interval \([-1, 1]\):

\[
A = \int_{-1}^{1} \ell_0(x)\,dx = \int_{-1}^{1} \frac{x(x - 1)}{2}\,dx
= \frac{1}{2} \int_{-1}^{1} (x^2 - x)\,dx
= \frac{1}{2} \left( \frac{2}{3} - 0 \right) = \frac{1}{3}
\]

\[
B = \int_{-1}^{1} \ell_1(x)\,dx = \int_{-1}^{1} - (x^2 - 1)\,dx
= - \left( \frac{2}{3} - 2 \right) = \frac{4}{3}
\]

\[
C = \int_{-1}^{1} \ell_2(x)\,dx = \int_{-1}^{1} \frac{x(x + 1)}{2}\,dx
= \frac{1}{2} \int_{-1}^{1} (x^2 + x)\,dx
= \frac{1}{2} \left( \frac{2}{3} + 0 \right) = \frac{1}{3}
\]

So, the exact quadrature rule using interpolation is:

\[
\int_{-1}^{1} f(x)\,dx \approx \frac{1}{3} f(-1) + \frac{4}{3} f(0) + \frac{1}{3} f(1)
\]

However, the given formula uses equal weights:

\[
\frac{2}{3} [f(-1) + f(0) + f(1)]
\]

Letâ€™s now test this rule on monomials to determine the degree of exactness.

\begin{itemize}
  \item \( f(x) = 1 \):
  \[
  \text{lhs: } \int_{-1}^{1} 1\,dx = 2, \quad
  \text{rhs: } \frac{2}{3} (1 + 1 + 1) = 2 \quad \Rightarrow \text{Exact}
  \]

  \item \( f(x) = x \):
  \[
  \text{lhs: } \int_{-1}^{1} x\,dx = 0, \quad
  \text{rhs: } \frac{2}{3} (-1 + 0 + 1) = 0 \quad \Rightarrow \text{Exact}
  \]

  \item \( f(x) = x^2 \):
  \[
  \text{lhs: } \int_{-1}^{1} x^2\,dx = \frac{2}{3}, \quad
  \text{rhs: } \frac{2}{3} (1 + 0 + 1) = \frac{4}{3} \quad \Rightarrow \text{Not Exact}
  \]
\end{itemize}


In conclusion, the formula integrates polynomials of degree 0 and 1 exactly, but not degree 2. Therefore, the degree of exactness is:

\[
\boxed{1}
\]

\section*{Problem 2}
Check if
\[
    \int_{0}^{b} f(x) \, dx = \frac{b}{3} \bigg[2f\bigg(\frac{b}{4}\bigg) - f\bigg(\frac{b}{2}\bigg) + 2f\bigg(\frac{3b}{4}\bigg)\bigg] +R(f)
\]
has the degree of exactness of 3.

\

We are to check if this rule has \textbf{degree of exactness 3}. That is, whether it integrates exactly all polynomials \( f(x) = x^n \) for \( n = 0, 1, 2, 3 \).

\subsection*{Case 1: \( f(x) = 1 \)}

\[
\int_{0}^{b} 1\, dx = b
\]

\[
\text{RHS} = \frac{b}{3} \left[2(1) - 1 + 2(1)\right] = \frac{b}{3}(3) = b \quad \Rightarrow \text{Exact}
\]

\subsection*{Case 2: \( f(x) = x \)}

\[
\int_{0}^{b} x\, dx = \frac{b^2}{2}
\]

\[
\text{rhs} = \frac{b}{3} \left[2\left(\frac{b}{4}\right) - \left(\frac{b}{2}\right) + 2\left(\frac{3b}{4}\right)\right]
= \frac{b}{3} \left( \frac{b}{2} - \frac{b}{2} + \frac{3b}{2} \right) = \frac{b}{3} \cdot \frac{3b}{2} = \frac{b^2}{2}
\quad \Rightarrow \text{Exact}
\]

\subsection*{Case 3: \( f(x) = x^2 \)}

\[
\int_{0}^{b} x^2\, dx = \frac{b^3}{3}
\]

\[
\text{rhs} = \frac{b}{3} \left[ 2\left( \frac{b}{4} \right)^2 - \left( \frac{b}{2} \right)^2 + 2\left( \frac{3b}{4} \right)^2 \right]
= \frac{b}{3} \left[ 2\cdot\frac{b^2}{16} - \frac{b^2}{4} + 2\cdot\frac{9b^2}{16} \right]
\]

\[
= \frac{b}{3} \left[ \frac{2b^2}{16} - \frac{b^2}{4} + \frac{18b^2}{16} \right]
= \frac{b}{3} \left[ \frac{2b^2 + 18b^2}{16} - \frac{b^2}{4} \right]
= \frac{b}{3} \left[ \frac{20b^2}{16} - \frac{4b^2}{16} \right]
= \frac{b}{3} \cdot \frac{16b^2}{16}
= \frac{b^3}{3}
\quad \Rightarrow \text{Exact}
\]

\subsection*{Case 4: \( f(x) = x^3 \)}

\[
\int_{0}^{b} x^3\, dx = \frac{b^4}{4}
\]

\[
\text{rhs} = \frac{b}{3} \left[ 2\left( \frac{b}{4} \right)^3 - \left( \frac{b}{2} \right)^3 + 2\left( \frac{3b}{4} \right)^3 \right]
= \frac{b}{3} \left[ 2\cdot\frac{b^3}{64} - \frac{b^3}{8} + 2\cdot\frac{27b^3}{64} \right]
\]

\[
= \frac{b}{3} \left[ \frac{2b^3}{64} - \frac{8b^3}{64} + \frac{54b^3}{64} \right]
= \frac{b}{3} \cdot \frac{48b^3}{64} = \frac{b}{3} \cdot \frac{3b^3}{4}
= \frac{b^4}{4}
\quad \Rightarrow \text{Exact}
\]

In conclusion, the quadrature rule integrates all polynomials of degree up to 3 exactly. Therefore, its degree of exactness is:

\[
\boxed{3}
\]

\section*{Problem 3}
Find n \(\in\) N such that \( \int_{1}^{2} xln(x) \, dx \) is approximated by the Repeated Simpson formula with precision \(\epsilon\) = \(10^{-5}\)
\

The Simpson formula is given by:
\[
    \int_{a}^{b} f(x) \, dx = \frac{b-a}{6n} \bigg[f(a) + 2\sum_{k=1}^{n-1}f(x_k) + f(b) + 4\sum_{k=1}^{n-1}f(\frac{x_k + x_{k+1}}{2})\bigg] - R(f)
\]
Where R(f) is the reminder term defined by:
\[
    R(f) = \frac{(b-a)^5}{2880n^4}f^{(4)}(\xi), \quad \xi \in [a,b]
\]
We have to find \( n \) such that:
\[
    \big|R(f)\big| < \epsilon
\]
First find the derivatives of \( f(x) = xln(x) \):
\begin{align*}
f'(x) &= \ln x + 1 &\quad f''(x) &= \frac{1}{x} \\
f^{(3)}(x) &= -\frac{1}{x^2} &\quad f^{(4)}(x) &= \frac{2}{x^3}
\end{align*}

We have:
\[
    \left|R(f)\right| = \left| \frac{1^5}{2880n^4} \cdot \frac{2}{\xi^3} \right| \leq 10^{-5}
\]
Assuming the worst case \( \xi = 1 \), we get:
\begin{align*}
    \frac{2}{2880n^4} &\leq 10^{-5} \\
    \frac{1}{1440n^4} &\leq 10^{-5} \\
    1440n^4 &\geq 10^5 \\
    n^4 &\geq \frac{10^5}{1440} \\
    n &\geq \sqrt[4]{\frac{10^5}{1440}} \approx 2.89
\end{align*}
Thus, the smallest integer satisfying the condition is:
\[
    \boxed{n \geq 3}
\]

\section*{Problem 4}
Approximate:
\[
    \int_{1}^{3} \frac{x}{x^2 + 4}  \, dx
\]
using the Repeated trapezium formula with \text{n = 2}.

\
\

The Repeated Trapezium formula is given by:
\[
    \int_{a}^{b} f(x) \, dx = \frac{b-a}{2n} \bigg[f(a) + 2\sum_{k=1}^{n-1}f(x_k) + f(b)\bigg] - R(f)
\]
With R(f) being the reminder term defined by:
\[
    R(f) = \frac{(b-a)^3}{12n^2}f^{(2)}(\xi), \quad \xi \in [a,b]
\]

Using the known values, we have:

\[
    \int_{1}^{3} \frac{x}{x^2 + 4}  \, dx = \frac{3-1}{2\cdot 2} \bigg[f(1) + 2f(2) + f(3)\bigg] - R(f)
\]
With R(f) being:
\[
    R(f) = \frac{(3-1)^3}{12\cdot 2^2}f^{(2)}(\xi), \quad \xi \in [1,3]
\]

We compute:
\[
f(1) = \frac{1}{5}, \quad f(2) = \frac{1}{4}, \quad f(3) = \frac{3}{13}
\]
\[
\Rightarrow \int_{1}^{3} \frac{x}{x^2 + 4}  \, dx \approx \frac{1}{2} \left( \frac{1}{5} + 2 \cdot \frac{1}{4} + \frac{3}{13} \right)
\]
\[
= \frac{1}{2} \left(0.2 + 0.5 + 0.2308\right) = \frac{1}{2} \cdot 0.9308 \approx 0.4654
\]

Estimate remainder:
\[
R(f) = \frac{8}{48} f^{(2)}(\xi) = \frac{1}{6} f^{(2)}(\xi)
\]
We compute the second derivative of \( f(x) = \frac{x}{x^2 + 4} \):

\[
f'(x) = \frac{-x^2 + 4}{(x^2 + 4)^2}, \quad
f''(x) = \frac{-2x(x^2 + 4)^2 - (-x^2 + 4)\cdot 4x(x^2 + 4)}{(x^2 + 4)^4}
\]

Evaluating at the endpoints:
\[
f''(1) \approx -0.176, \quad f''(3) \approx -0.0082
\Rightarrow |f''(\xi)| \leq 0.176 \text{ on } [1, 3]
\]

Then the remainder is:
\[
|R(f)| \leq \frac{(3 - 1)^3}{12 \cdot 2^2} \cdot 0.176 = \frac{8}{48} \cdot 0.176 \approx 0.0293
\]

Final approximation:
\[
    \boxed{\int_{1}^{3} \frac{x}{x^2 + 4} \, dx \approx 0.4654 \pm 0.0293}
\]

\end{document}
